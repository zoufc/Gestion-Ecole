<div class="flex flex-col gap-6 p-6">
  <!-- En-tête avec bouton retour -->
  <div class="flex items-center gap-4">
    <button (click)="goBack()" class="p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"
          stroke-linejoin="round" />
      </svg>
    </button>
    <h1 class="text-2xl font-bold text-primary-text">Détails du paiement</h1>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="flex justify-center items-center py-20">
    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500"></div>
  </div>

  <!-- Payment Details -->
  <div *ngIf="!isLoading && payment" class="flex flex-col gap-6">
    <!-- Informations du paiement -->
    <div class="bg-card rounded-lg shadow-md p-6">
      <h2 class="text-xl font-bold mb-4 text-primary-text">Informations du paiement</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <p class="text-sm text-gray-500 mb-1">Montant</p>
          <p class="text-lg font-semibold text-primary-text">{{ formatAmount(payment.amount) }}</p>
        </div>
        <div>
          <p class="text-sm text-gray-500 mb-1">Mois</p>
          <p class="text-lg font-semibold text-primary-text">{{ getMonthLabel(payment.month) }}</p>
        </div>
        <div>
          <p class="text-sm text-gray-500 mb-1">Méthode de paiement</p>
          <p class="text-lg font-semibold text-primary-text">{{ getPaymentMethodLabel(payment.method) }}</p>
        </div>
        <div>
          <p class="text-sm text-gray-500 mb-1">Statut</p>
          <span [ngClass]="getStatusClass(payment.status)" class="px-3 py-1 rounded-full text-sm font-semibold">
            {{ getStatusLabel(payment.status) }}
          </span>
        </div>
        <div>
          <p class="text-sm text-gray-500 mb-1">Référence</p>
          <p class="text-lg font-semibold text-primary-text">{{ payment.reference || '-' }}</p>
        </div>
        <div>
          <p class="text-sm text-gray-500 mb-1">Date de paiement</p>
          <p class="text-lg font-semibold text-primary-text">{{ formatDate(payment.paymentDate) }}</p>
        </div>
        <div>
          <p class="text-sm text-gray-500 mb-1">Date de création</p>
          <p class="text-lg font-semibold text-primary-text">{{ formatDate(payment.created_at) }}</p>
        </div>
      </div>
    </div>

    <!-- Informations de l'élève -->
    <div class="bg-card rounded-lg shadow-md p-6">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-bold text-primary-text">Informations de l'élève</h2>
        <button
          (click)="goToStudentDetail()"
          class="px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors flex items-center gap-2"
        >
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M10 9C11.6569 9 13 7.65685 13 6C13 4.34315 11.6569 3 10 3C8.34315 3 7 4.34315 7 6C7 7.65685 8.34315 9 10 9Z" fill="currentColor"/>
            <path d="M10 11C7.23858 11 5 13.2386 5 16V17H15V16C15 13.2386 12.7614 11 10 11Z" fill="currentColor"/>
          </svg>
          Voir les détails de l'élève
        </button>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <p class="text-sm text-gray-500 mb-1">Nom complet</p>
          <p class="text-lg font-semibold text-primary-text">{{ getStudentName() }}</p>
        </div>
        <div>
          <p class="text-sm text-gray-500 mb-1">Code étudiant</p>
          <p class="text-lg font-semibold text-primary-text">{{ getStudentCode() }}</p>
        </div>
        <div>
          <p class="text-sm text-gray-500 mb-1">Classe</p>
          <p class="text-lg font-semibold text-primary-text">{{ getClassName() }}</p>
        </div>
        <div>
          <p class="text-sm text-gray-500 mb-1">École</p>
          <p class="text-lg font-semibold text-primary-text">{{ getSchoolName() }}</p>
        </div>
        <div *ngIf="payment.student?.birthDate">
          <p class="text-sm text-gray-500 mb-1">Date de naissance</p>
          <p class="text-lg font-semibold text-primary-text">{{ formatDate(payment.student.birthDate) }}</p>
        </div>
        <div *ngIf="payment.student?.gender">
          <p class="text-sm text-gray-500 mb-1">Genre</p>
          <p class="text-lg font-semibold text-primary-text">
            {{ payment.student.gender === 'MALE' ? 'Masculin' : payment.student.gender === 'FEMALE' ? 'Féminin' : payment.student.gender }}
          </p>
        </div>
      </div>
    </div>

    <!-- Informations du parent (si disponibles) -->
    <div *ngIf="hasParentInfo()" class="bg-card rounded-lg shadow-md p-6">
      <h2 class="text-xl font-bold mb-4 text-primary-text">Informations du parent</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div *ngIf="getParentName()">
          <p class="text-sm text-gray-500 mb-1">Nom complet</p>
          <p class="text-lg font-semibold text-primary-text">{{ getParentName() }}</p>
        </div>
        <div *ngIf="getParentEmail()">
          <p class="text-sm text-gray-500 mb-1">Email</p>
          <p class="text-lg font-semibold text-primary-text">{{ getParentEmail() }}</p>
        </div>
        <div *ngIf="getParentPhone()">
          <p class="text-sm text-gray-500 mb-1">Téléphone</p>
          <p class="text-lg font-semibold text-primary-text">{{ getParentPhone() }}</p>
        </div>
      </div>
    </div>
  </div>

  <!-- No Payment Found -->
  <div *ngIf="!isLoading && !payment" class="flex flex-col items-center justify-center py-20">
    <p class="text-xl text-gray-500 mb-4">Paiement non trouvé</p>
    <button (click)="goBack()" class="px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors">
      Retour à la liste
    </button>
  </div>
</div>

